{"version":3,"file":"theme-extension-config.js","sourceRoot":"","sources":["../../../../src/cli/services/deploy/theme-extension-config.ts"],"names":[],"mappings":"AACA,OAAO,EAAC,IAAI,EAAE,IAAI,EAAC,MAAM,kBAAkB,CAAA;AAS3C,MAAM,CAAC,KAAK,UAAU,oBAAoB,CAAC,cAA8B;IACvE,MAAM,KAAK,GAA4B,EAAE,CAAA;IACzC,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC,CAAA;IAC9E,MAAM,OAAO,CAAC,GAAG,CACf,UAAU,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAE,EAAE;QAChC,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAA;QACtE,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAA;QAC1C,MAAM,QAAQ,GAAG,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAA;QACzD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAC,QAAQ,EAAC,CAAC,CAAA;QAC1D,KAAK,CAAC,YAAY,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;IAC9E,CAAC,CAAC,CACH,CAAA;IACD,gEAAgE;IAChE,OAAO,EAAC,eAAe,EAAE,EAAC,KAAK,EAAC,EAAC,CAAA;AACnC,CAAC","sourcesContent":["import {ThemeExtension} from '../../models/app/app.js'\nimport {file, path} from '@shopify/cli-kit'\n\nexport interface ThemeExtensionConfig {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  theme_extension: {\n    files: {[key: string]: string}\n  }\n}\n\nexport async function themeExtensionConfig(themeExtension: ThemeExtension): Promise<ThemeExtensionConfig> {\n  const files: {[key: string]: string} = {}\n  const themeFiles = await path.glob(path.join(themeExtension.directory, '*/*'))\n  await Promise.all(\n    themeFiles.map(async (filepath) => {\n      const relativePath = path.relative(themeExtension.directory, filepath)\n      const dirname = path.dirname(relativePath)\n      const encoding = dirname === 'assets' ? 'binary' : 'utf8'\n      const fileContents = await file.read(filepath, {encoding})\n      files[relativePath] = Buffer.from(fileContents, encoding).toString('base64')\n    }),\n  )\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  return {theme_extension: {files}}\n}\n"]}